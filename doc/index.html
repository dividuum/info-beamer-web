<html>
  <head>
    <title>Info Beamer Reference Manual</title>
    <style>
      body {
        font-size: 18px;
        background-color: #FFF;
        width: 820px;
        margin: auto;
        font-family: Helvetica, Arial, sans-serif;
      }
      #head {
      }
      #head h1 {
        background-color: transparent;
        font-size: 80px;
      }
      #head img {
        padding: 0;
      }
      #copy {
        font-size: 14px;
      }
      h1, h2, h3 {
        font-family: Verdana, Geneva, sans-serif;
        font-weight: normal;
        font-style: italic;
      }
      h1 {
        font-size: 40px;
        margin-left: -30px;
        padding: 0.2em 0.4em 0.2em 30px;
        background-color: #E0E0FF;
      }
      h2 {
        font-size: 25px;
        margin-left: -30px;
        padding-left: 30px;
        border-bottom: 10px solid #E0E0FF;
      }
      h3 {
        font-size: 14px;
        margin-left: -30px;
        font-weight: bold;
        padding: 0.4em 0.4em 0.4em 10px;
        border-left: 20px solid #E0E0FF;
        border-bottom: 3px solid #E0E0FF;
      }
      h4 {
        border-bottom: 2px solid #E0E0FF;
        font-size: 15px;
      }
      img {
        padding-top: 0.8em ;
        padding-bottom: 0.8em ;
      }
      .codehilite pre {
        color: #555;
        background-color: #EEE;
        border: 1px solid #555;
        display: block;
        padding: 10px;
      }
      td {
        padding-right: 40px;
      }
      th {
        text-align: left;
      }
      a:link {
        color: #000080 ;
        background-color: inherit ;
        text-decoration: none ;
      }

      a:visited {
        background-color: inherit ;
        text-decoration: none ;
      }

      a:link:hover, a:visited:hover {
        color: #000080 ;
        background-color: #E0E0FF ;
      }

      a:link:active, a:visited:active {
        color: #FF0000 ;
      }
      .toc {
        margin-left: -30px;
      }
      .toc ul {
        list-style-type: none;
        padding-left: 30px;
      }
      .codehilite .hll { background-color: #ffffcc }
      .codehilite .c { color: #0099FF; font-style: italic } /* Comment */
      .codehilite .err { color: #AA0000; background-color: #FFAAAA } /* Error */
      .codehilite .k { color: #006699; font-weight: bold } /* Keyword */
      .codehilite .o { color: #555555 } /* Operator */
      .codehilite .cm { color: #0099FF; font-style: italic } /* Comment.Multiline */
      .codehilite .cp { color: #009999 } /* Comment.Preproc */
      .codehilite .c1 { color: #0099FF; font-style: italic } /* Comment.Single */
      .codehilite .cs { color: #0099FF; font-weight: bold; font-style: italic } /* Comment.Special */
      .codehilite .gd { background-color: #FFCCCC; border: 1px solid #CC0000 } /* Generic.Deleted */
      .codehilite .ge { font-style: italic } /* Generic.Emph */
      .codehilite .gr { color: #FF0000 } /* Generic.Error */
      .codehilite .gh { color: #003300; font-weight: bold } /* Generic.Heading */
      .codehilite .gi { background-color: #CCFFCC; border: 1px solid #00CC00 } /* Generic.Inserted */
      .codehilite .go { color: #AAAAAA } /* Generic.Output */
      .codehilite .gp { color: #000099; font-weight: bold } /* Generic.Prompt */
      .codehilite .gs { font-weight: bold } /* Generic.Strong */
      .codehilite .gu { color: #003300; font-weight: bold } /* Generic.Subheading */
      .codehilite .gt { color: #99CC66 } /* Generic.Traceback */
      .codehilite .kc { color: #006699; font-weight: bold } /* Keyword.Constant */
      .codehilite .kd { color: #006699; font-weight: bold } /* Keyword.Declaration */
      .codehilite .kn { color: #006699; font-weight: bold } /* Keyword.Namespace */
      .codehilite .kp { color: #006699 } /* Keyword.Pseudo */
      .codehilite .kr { color: #006699; font-weight: bold } /* Keyword.Reserved */
      .codehilite .kt { color: #007788; font-weight: bold } /* Keyword.Type */
      .codehilite .m { color: #FF6600 } /* Literal.Number */
      .codehilite .s { color: #CC3300 } /* Literal.String */
      .codehilite .na { color: #330099 } /* Name.Attribute */
      .codehilite .nb { color: #336666 } /* Name.Builtin */
      .codehilite .nc { color: #00AA88; font-weight: bold } /* Name.Class */
      .codehilite .no { color: #336600 } /* Name.Constant */
      .codehilite .nd { color: #9999FF } /* Name.Decorator */
      .codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
      .codehilite .ne { color: #CC0000; font-weight: bold } /* Name.Exception */
      .codehilite .nf { color: #CC00FF } /* Name.Function */
      .codehilite .nl { color: #9999FF } /* Name.Label */
      .codehilite .nn { color: #00CCFF; font-weight: bold } /* Name.Namespace */
      .codehilite .nt { color: #330099; font-weight: bold } /* Name.Tag */
      .codehilite .nv { color: #003333 } /* Name.Variable */
      .codehilite .ow { color: #000000; font-weight: bold } /* Operator.Word */
      .codehilite .w { color: #bbbbbb } /* Text.Whitespace */
      .codehilite .mf { color: #FF6600 } /* Literal.Number.Float */
      .codehilite .mh { color: #FF6600 } /* Literal.Number.Hex */
      .codehilite .mi { color: #FF6600 } /* Literal.Number.Integer */
      .codehilite .mo { color: #FF6600 } /* Literal.Number.Oct */
      .codehilite .sb { color: #CC3300 } /* Literal.String.Backtick */
      .codehilite .sc { color: #CC3300 } /* Literal.String.Char */
      .codehilite .sd { color: #CC3300; font-style: italic } /* Literal.String.Doc */
      .codehilite .s2 { color: #CC3300 } /* Literal.String.Double */
      .codehilite .se { color: #CC3300; font-weight: bold } /* Literal.String.Escape */
      .codehilite .sh { color: #CC3300 } /* Literal.String.Heredoc */
      .codehilite .si { color: #AA0000 } /* Literal.String.Interpol */
      .codehilite .sx { color: #CC3300 } /* Literal.String.Other */
      .codehilite .sr { color: #33AAAA } /* Literal.String.Regex */
      .codehilite .s1 { color: #CC3300 } /* Literal.String.Single */
      .codehilite .ss { color: #FFCC33 } /* Literal.String.Symbol */
      .codehilite .bp { color: #336666 } /* Name.Builtin.Pseudo */
      .codehilite .vc { color: #003333 } /* Name.Variable.Class */
      .codehilite .vg { color: #003333 } /* Name.Variable.Global */
      .codehilite .vi { color: #003333 } /* Name.Variable.Instance */
      .codehilite .il { color: #FF6600 } /* Literal.Number.Integer.Long */
    </style>
  </head>
  <body>
    <div id='head'>
      <h1>
        info-beamer<br/>
        Reference Manual
      </h1>
      <div id='copy'>
        By Florian Wesch &lt;fw@dividuum.de&gt;<br/>
        Copyright &copy; 2012 Florian Wesch. This manual is available under the same terms as Info Beamer itself.<br/>
        Style inspired by the <a href='http://www.lua.org/manual/'>Lua reference manual</a>. Icons where taken from the <a
          href='http://schollidesign.deviantart.com/art/Human-O2-Iconset-105344123'>Human O2 Iconset</a>.
      </div>
    </div>
<h1 id="introduction">Introduction</h1>
<h2 id="about">About</h2>
<p><code>info-beamer</code> is an interactive multimedia presentation framework. It is
somewhat similar to <a href="http://www.pawfal.org/fluxus/">fluxus</a> or
<a href="http://processing.org/">processing</a>. <code>info-beamer</code> allows you to create
impressive realtime visualisations using the <a href="http://www.lua.org/">Lua programming
language</a>.</p>
<h2 id="table-of-contents">Table of Contents</h2>
<div class="toc">
<ul>
<li><a href="#introduction">Introduction</a><ul>
<li><a href="#about">About</a></li>
<li><a href="#table-of-contents">Table of Contents</a></li>
</ul>
</li>
<li><a href="#installing-info-beamer">Installing info-beamer</a><ul>
<li><a href="#dependencies">Dependencies</a><ul>
<li><a href="#prerequisites-on-ubuntu">Prerequisites on Ubuntu</a></li>
</ul>
</li>
<li><a href="#building-from-source">Building From Source</a></li>
<li><a href="#installation">Installation</a></li>
</ul>
</li>
<li><a href="#first-steps">First Steps</a><ul>
<li><a href="#hello-world">Hello World</a></li>
<li><a href="#displaying-content">Displaying Content</a><ul>
<li><a href="#images">Images</a></li>
<li><a href="#videos">Videos</a></li>
<li><a href="#rendering-child-nodes">Rendering Child Nodes</a></li>
<li><a href="#rendering-from-vnc">Rendering from VNC</a></li>
<li><a href="#using-glsl-shaders">Using GLSL Shaders</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#reference">Reference</a><ul>
<li><a href="#resource-loading">Resource Loading</a><ul>
<li><a href="#image-resourceload_imagefilename">image = resource.load_image(filename)</a><ul>
<li><a href="#imagedrawx1-y1-x2-y2">image:draw(x1, y1, x2, y2)</a></li>
<li><a href="#width-height-imagesize">width, height = image:size()</a></li>
</ul>
</li>
<li><a href="#video-resourceload_videofilename">video = resource.load_video(filename)</a><ul>
<li><a href="#videodrawx1-y1-x2-y2">video:draw(x1, y1, x2, y2)</a></li>
<li><a href="#has_next_frame-videonext">has_next_frame = video:next()</a></li>
<li><a href="#width-height-videosize">width, height = video:size()</a></li>
<li><a href="#fps-videofps">fps = video:fps()</a></li>
</ul>
</li>
<li><a href="#font-resourceload_fontfilename">font = resource.load_font(filename)</a><ul>
<li><a href="#width-fontwritex-y-text-size-r-g-b-a">width = font:write(x, y, text, size, r, g, b, [a])</a></li>
<li><a href="#width-fontwritex-y-text-size-texturelike">width = font:write(x, y, text, size, texturelike)</a></li>
</ul>
</li>
<li><a href="#string-resourceload_filefilename">string = resource.load_file(filename)</a></li>
<li><a href="#shader-resourcecreate_shadervertex_shader-fragment_shader">shader = resource.create_shader(vertex_shader, fragment_shader)</a><ul>
<li><a href="#shaderusetable_of_shader_variables">shader:use(table_of_shader_variables)</a></li>
<li><a href="#shaderdeactivate">shader:deactivate()</a></li>
</ul>
</li>
<li><a href="#vnc-resourcecreate_vnchostname-port">vnc = resource.create_vnc(hostname, [port])</a><ul>
<li><a href="#vncdrawx1-y1-x2-y2">vnc:draw(x1, y1, x2, y2)</a></li>
<li><a href="#width-height-vncsize">width, height = vnc:size()</a></li>
<li><a href="#alive-vncalive">alive = vnc:alive()</a></li>
</ul>
</li>
<li><a href="#image-resourcerender_childname">image = resource.render_child(name)</a></li>
</ul>
</li>
<li><a href="#opengl-related-functions">OpenGL Related Functions</a><ul>
<li><a href="#glsetupwidth-height">gl.setup(width, height)</a></li>
<li><a href="#glclearr-g-b-a">gl.clear(r, g, b, a)</a></li>
<li><a href="#glpushmatrix">gl.pushMatrix()</a></li>
<li><a href="#glpopmatrix">gl.popMatrix()</a></li>
<li><a href="#glortho">gl.ortho()</a></li>
<li><a href="#glperspectivefov-eyex-eyey-eyez-centerx-centery-centerz">gl.perspective(fov, eyex, eyey, eyez, centerx, centery, centerz)</a></li>
<li><a href="#glrotateangle-x-y-z">gl.rotate(angle, x, y, z)</a></li>
<li><a href="#gltranslatex-y-z">gl.translate(x, y, z)</a></li>
</ul>
</li>
<li><a href="#misc-functions">Misc Functions</a><ul>
<li><a href="#sysnow">sys.now()</a></li>
</ul>
</li>
<li><a href="#node-functions">Node Functions</a><ul>
<li><a href="#noderender">node.render()</a></li>
<li><a href="#nodealiasnew_alias">node.alias(new_alias)</a></li>
<li><a href="#nodeeventevent_name-event_handler">node.event(event_name, event_handler)</a></li>
</ul>
</li>
<li><a href="#node-events">Node Events</a><ul>
<li><a href="#nodeeventchild_add-functionchild_name-end">node.event("child_add", function(child_name) ... end)</a></li>
<li><a href="#nodeeventchild_remove-functionchild_name-end">node.event("child_remove", function(child_name) ... end)</a></li>
<li><a href="#nodeeventcontent_update-functionfilename-end">node.event("content_update", function(filename) ... end)</a></li>
<li><a href="#nodeeventcontent_remove-functionfilename-end">node.event("content_remove", function(filename) ... end)</a></li>
<li><a href="#nodeeventdata-functiondata-suffix-end">node.event("data", function(data, suffix) ... end)</a></li>
<li><a href="#nodeeventosc-functionsuffix-end">node.event("osc", function(suffix, ...) ... end)</a></li>
<li><a href="#nodeeventinput-functionline-end">node.event("input", function(line) ... end)</a></li>
</ul>
</li>
<li><a href="#utility-functions">Utility Functions</a><ul>
<li><a href="#utilresource_loadertable_of_filenames">util.resource_loader(table_of_filenames)</a></li>
<li><a href="#utilshaderpair_loaderbasename">util.shaderpair_loader(basename)</a></li>
<li><a href="#utilosc_mapperrouting_table">util.osc_mapper(routing_table)</a></li>
<li><a href="#utildata_mapperrouting_table">util.data_mapper(routing_table)</a></li>
<li><a href="#video-utilvideoplayerfilename-opt_table">video = util.videoplayer(filename, [opt_table])</a><ul>
<li><a href="#videodrawx1-y1-x2-y2_1">video:draw(x1, y1, x2, y2)</a></li>
</ul>
</li>
<li><a href="#utildraw_correctobj-x1-y1-x2-y2-alpha">util.draw_correct(obj, x1, y1, x2, y2, alpha)</a></li>
<li><a href="#ppvariable">pp(variable)</a></li>
</ul>
</li>
<li><a href="#global-variables">Global Variables</a><ul>
<li><a href="#width">WIDTH</a></li>
<li><a href="#height">HEIGHT</a></li>
<li><a href="#name">NAME</a></li>
<li><a href="#path">PATH</a></li>
<li><a href="#contents">CONTENTS</a></li>
<li><a href="#childs">CHILDS</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#contributing">Contributing</a><ul>
<li><a href="#project-philosophy">Project Philosophy</a></li>
<li><a href="#contributing_1">Contributing</a></li>
</ul>
</li>
</ul>
</div>
<h1 id="installing-info-beamer">Installing info-beamer</h1>
<p><code>info-beamer</code> is currently focused on Linux. It has been tested on Ubuntu
and Fedora.</p>
<h2 id="dependencies">Dependencies</h2>
<p><code>info-beamer</code> tries to have dependencies that are available for most linux
distributions. It shouldn't be necessary to compile obscure packages before
compiling <code>info-beamer</code>. Here are the required 3rd party packages:</p>
<table>
<thead>
<tr>
<th>Dependency</th>
<th>Why?</th>
</tr>
</thead>
<tbody>
<tr>
<td>lua (5.1)</td>
<td>for scripting</td>
</tr>
<tr>
<td>libevent (&gt;2.0)</td>
<td>io multiplexing</td>
</tr>
<tr>
<td>glfw</td>
<td>opengl initialization</td>
</tr>
<tr>
<td>GL &amp; GLU</td>
<td>opengl &amp; utility functions</td>
</tr>
<tr>
<td>GLEW</td>
<td>accessing opengl extensions</td>
</tr>
<tr>
<td>ftgl</td>
<td>truetype font rendering for opengl</td>
</tr>
<tr>
<td>DevIL</td>
<td>reading image files</td>
</tr>
<tr>
<td>libavformat</td>
<td>video decoding</td>
</tr>
<tr>
<td>libavcodec</td>
<td />
</tr>
<tr>
<td>libavutil</td>
<td />
</tr>
<tr>
<td>libswscale</td>
<td />
</tr>
<tr>
<td>libz</td>
<td />
</tr>
<tr>
<td>markdown (python)</td>
<td>(optional) for rebuilding the documentation</td>
</tr>
</tbody>
</table>
<h3 id="prerequisites-on-ubuntu">Prerequisites on Ubuntu</h3>
<p>Ubuntu provides all required packages. Just execute the following command:</p>
<div class="codehilite"><pre><span class="gp">user:~$</span> apt-get install liblua5.1-dev libevent-dev libglfw-dev <span class="se">\</span>
<span class="go">    libglew1.5-dev libftgl-dev libavcodec-dev libswscale-dev \</span>
<span class="go">    libavformat-dev libdevil-dev</span>
</pre></div>


<h2 id="building-from-source">Building From Source</h2>
<p><code>info-beamer</code> is provided as a source release on
<a href="http://github.com/dividuum/info-beamer">http://github.com/dividuum/info-beamer</a>.
The best way to install <code>info-beamer</code> is to clone the github repository and
type <code>make</code> inside the root directory:</p>
<div class="codehilite"><pre><span class="gp">user:~/src$</span> git clone https://github.com/dividuum/info-beamer.git
<span class="go">[...]</span>
<span class="gp">user:~/src$</span> <span class="nb">cd </span>info-beamer
<span class="gp">user:~/src/info-beamer$</span> make
<span class="go">[...]</span>
<span class="gp">user:~/src/info-beamer$</span> ./info-beamer 
<span class="go">Info Beamer rev-foobar (http://dividuum.de/info-beamer)</span>
<span class="go">Copyright (c) 2012, Florian Wesch &lt;fw@dividuum.de&gt;</span>

<span class="go">usage: ./info-beamer &lt;root_name&gt;</span>
</pre></div>


<h2 id="installation">Installation</h2>
<p>There is nothing special to do. <code>info-beamer</code> consists of only a single
binary called <code>info-beamer</code>. You can move it to any directory you like
(e.g. <code>/usr/local/bin</code>). Or you can call <code>make install</code> to install
<code>info-beamer</code> into <code>/usr/local/bin</code>.</p>
<div class="codehilite"><pre><span class="gp">user:~/src/info-beamer$</span> sudo make install
<span class="go">install -o root -g root -m 755 info-beamer /usr/local/bin/</span>
</pre></div>


<h1 id="first-steps">First Steps</h1>
<h2 id="hello-world">Hello World</h2>
<p><code>info-beamer</code> uses directories as presentable units. A minimal example
consists of a single directory (called a node) containing a font file and a
control file <code>node.lua</code>. Let's look at the example code in <code>samples/hello</code>:</p>
<div class="codehilite"><pre><span class="n">gl</span><span class="p">.</span><span class="n">setup</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">768</span><span class="p">)</span>

<span class="n">font</span> <span class="o">=</span> <span class="n">resource</span><span class="p">.</span><span class="n">load_font</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">silkscreen.ttf&quot;</span><span class="p">)</span>

<span class="k">function</span> <span class="nc">node</span><span class="p">.</span><span class="nf">render</span><span class="p">()</span>
    <span class="n">font</span><span class="p">:</span><span class="n">write</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">Hello World&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>


<p><img alt="hello world" src="hello.png" /></p>
<p>Let's look at each line:</p>
<div class="codehilite"><pre><span class="n">gl</span><span class="p">.</span><span class="n">setup</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">768</span><span class="p">)</span>
</pre></div>


<p>This call will initialize a virtual screen of width 1024 and height 768.
The virtual screen is the node's window to the world. The virtual screen is
scaled up to the available display space.</p>
<div class="codehilite"><pre><span class="n">font</span> <span class="o">=</span> <span class="n">resource</span><span class="p">.</span><span class="n">load_font</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">silkscreen.ttf&quot;</span><span class="p">)</span>
</pre></div>


<p>This line will read the Truetype font <code>silkscreen.ttf</code> and create a font
object <code>font</code>. This object can then be used to write output using the font.</p>
<div class="codehilite"><pre><span class="k">function</span> <span class="nc">node</span><span class="p">.</span><span class="nf">render</span><span class="p">()</span>
    <span class="n">font</span><span class="p">:</span><span class="n">write</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">Hello World&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>


<p><code>info-beamer</code> will call the function <code>node.render</code> for each frame it will
display on the screen. Inside of <code>node.render</code> it's up to you to decide
what do show on each frame. In this example we use the previously create
<code>font</code> object to write <code>"Hello World"</code> to the virtual screen.</p>
<p>The first two parameters of <code>write</code> are the x and y Position on the virtual
screen. <code>x</code> is the horizontal position. A value of 0 is the leftmost
position. <code>y</code> is the vertical position. The value 0 is the topmost
position. Therefore <code>x=0, y=0</code> is in the topleft corner of the virtual
screen.</p>
<p><img alt="coordinate system" src="coordinates.png" /></p>
<p><code>"Hello World"</code> is obviously the value we want to put on the virtual
screen.  <code>100</code> is the size of the output in screen units. <code>1,1,1,1</code> is
color in RGBA format (a bright white).</p>
<p>To display this example using <code>info-beamer</code>, switch into the <code>samples</code>
directory and type </p>
<div class="codehilite"><pre><span class="gp">user:~/src/info-beamer$</span> <span class="nb">cd </span>samples
<span class="gp">user:~/src/info-beamer/samples$</span> ../info-beamer hello
</pre></div>


<p>This will start <code>info-beamer</code>. It will open the directory <code>hello</code> (called
the <code>hello</code> node) and look for the file <code>node.lua</code>. This should get
you a new window showing the "Hello World" text in the center to the
screen. </p>
<p><code>info-beamer</code> is a rapid development environment. If you update the code
for your example and save it, <code>info-beamer</code> will pickup the changes and
show them to you immediatelly. Let's try this: While <code>info-beamer</code> is still
running and displaying the "Hello World", change the string "Hello World"
to "Updated World" in <code>node.lua</code> and save the file <code>node.lua</code>.
<code>info-beamer</code> will notice that the file changed and reload it. The output
window will now show the text <code>"Updated World"</code> to you!</p>
<h2 id="displaying-content">Displaying Content</h2>
<h3 id="images">Images</h3>
<p><code>info-beamer</code> can load more than just font files. It will load various
image formats using the <code>resource.load_image</code> function. Code using this
function might look like this:</p>
<div class="codehilite"><pre><span class="n">gl</span><span class="p">.</span><span class="n">setup</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">768</span><span class="p">)</span>

<span class="n">background</span> <span class="o">=</span> <span class="n">resource</span><span class="p">.</span><span class="n">load_image</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">background.jpg&quot;</span><span class="p">)</span>

<span class="k">function</span> <span class="nc">node</span><span class="p">.</span><span class="nf">render</span><span class="p">()</span>
    <span class="n">background</span><span class="p">:</span><span class="n">draw</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>


<p>The image <code>background.jpg</code> will be loaded into the image object
<code>background</code>. Inside <code>node.render</code> this background image is the drawn from
coordinates <code>0, 0</code> (top left corner of the virtualscreen) to <code>WIDTH,
HEIGHT</code> (bottom right corner of the screen). WIDTH and HEIGHT will be
initialized with the values from the <code>gl.setup</code> call.</p>
<h3 id="videos">Videos</h3>
<p>You can load videos and display them. Doing so is quite similar to image
loading:</p>
<div class="codehilite"><pre><span class="n">gl</span><span class="p">.</span><span class="n">setup</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">768</span><span class="p">)</span>

<span class="n">video</span> <span class="o">=</span> <span class="n">resource</span><span class="p">.</span><span class="n">load_video</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">video.mp4&quot;</span><span class="p">)</span>

<span class="k">function</span> <span class="nc">node</span><span class="p">.</span><span class="nf">render</span><span class="p">()</span>
    <span class="n">video</span><span class="p">:</span><span class="nb">next</span><span class="p">()</span>
    <span class="n">video</span><span class="p">:</span><span class="n">draw</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>


<p><code>video</code> now contains a video object. Calling <code>video:next</code> will read the
next frame of the video. <code>video:draw</code> will then display this frame. You'll
notice that video playback will be too fast. Since <code>node.render</code> is called
for each frame <code>info-beamer</code> wants to display, it's most likely that this
function will be called 60 times per seconds (the refresh rate of your
monitor).  Likewise your video might have 25 frames per seconds. So
you'll have to slow down decoding to the actual framerate of the video.
<code>util.videoplayer</code> will do all of this for you:</p>
<div class="codehilite"><pre><span class="n">gl</span><span class="p">.</span><span class="n">setup</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">768</span><span class="p">)</span>

<span class="n">video</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">videoplayer</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">video.mp4&quot;</span><span class="p">)</span>

<span class="k">function</span> <span class="nc">node</span><span class="p">.</span><span class="nf">render</span><span class="p">()</span>
    <span class="n">video</span><span class="p">:</span><span class="n">draw</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>


<p><code>util.videoplayer</code> is a helper function that provides a small wrapper
around video resources. It will automatically decode the video using the
correct framerate.</p>
<h3 id="rendering-child-nodes">Rendering Child Nodes</h3>
<p>A directory (called a node) can contain subdirectories. Each subdirectory
is then loaded as a child node. The parent node can render child nodes like
any other resource. Let's say we create two nodes called <em>Blue</em> and <em>Red</em>.
We can let <code>info-beamer</code> play each of them individually. But what if we
want to combine them for our presentation? This is where the nesting
feature of <code>info-beamer</code> becomes useful. You start by creating another node
called <em>Green</em>. Then you just move the directories for node <em>Blue</em> and
<em>Red</em> into the directory <em>Green</em>. The file tree will the look like this:</p>
<div class="codehilite"><pre>-+- green -+- node.lua
           |
           +- red ---- node.lua
           |
           &#39;- blue --- node.lua
</pre></div>


<p>Inside of <em>Green</em> you can then render both <em>Red</em> and <em>Blue</em> into an image
object using <code>resource.render_child</code> and display them on <em>Green</em>s virtual screen.</p>
<p><img alt="nested rendering" src="nested.png" /></p>
<p>The above setup is available in the directory <code>samples/blue</code>. It contains
<code>node.lua</code> and two child directories called <code>red</code> and <code>blue</code>.  Let's look at
<code>green/node.lua</code>:</p>
<div class="codehilite"><pre><span class="n">gl</span><span class="p">.</span><span class="n">setup</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>

<span class="k">function</span> <span class="nc">node</span><span class="p">.</span><span class="nf">render</span><span class="p">()</span>
    <span class="n">gl</span><span class="p">.</span><span class="n">clear</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">-- green</span>

    <span class="c1">-- render to image object and draw</span>
    <span class="kd">local</span> <span class="n">red</span> <span class="o">=</span> <span class="n">resource</span><span class="p">.</span><span class="n">render_child</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">red&quot;</span><span class="p">)</span>
    <span class="n">red</span><span class="p">:</span><span class="n">draw</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">780</span><span class="p">,</span> <span class="mi">580</span><span class="p">)</span>

    <span class="c1">-- render an draw without creating an intermediate variable</span>
    <span class="n">resource</span><span class="p">.</span><span class="n">render_child</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">blue&quot;</span><span class="p">):</span><span class="n">draw</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">380</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>


<p>It creates a new virtual screen sized 800x600. For each frame it clears the
screen using <code>gl.clear</code> with a bright green.</p>
<p>Then it renders the child node <code>red</code> (aka the subdirectory <code>red</code>) into
a new image object called <code>red</code> and draws it into the square from <code>640,20</code> to
<code>780,580</code>. The sourcecode for <code>green/red/node.lua</code> looks like
this:</p>
<div class="codehilite"><pre><span class="n">gl</span><span class="p">.</span><span class="n">setup</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>

<span class="k">function</span> <span class="nc">node</span><span class="p">.</span><span class="nf">render</span><span class="p">()</span>
    <span class="n">gl</span><span class="p">.</span><span class="n">clear</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">-- red</span>
<span class="k">end</span>
</pre></div>


<p>It starts by setting up a 100x800 screen. Each time it is is rendered
(which happens if <code>resource.render_child</code> is called), the child clears the
screen by calling <code>gl.clear</code> with the color red. </p>
<p><code>green/blue/node.lua</code> looks almost identical but clears the screen with a
bright blue:</p>
<div class="codehilite"><pre><span class="n">gl</span><span class="p">.</span><span class="n">setup</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">480</span><span class="p">)</span>

<span class="k">function</span> <span class="nc">node</span><span class="p">.</span><span class="nf">render</span><span class="p">()</span>
    <span class="n">gl</span><span class="p">.</span><span class="n">clear</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">-- blue</span>
<span class="k">end</span>
</pre></div>


<p>You can start the example like this:</p>
<div class="codehilite"><pre><span class="gp">user:~/src/info-beamer/samples$</span> ../info-beamer green
</pre></div>


<p>You can also start both childs on their own:</p>
<div class="codehilite"><pre><span class="gp">user:~/src/info-beamer/samples$</span> <span class="nb">cd </span>green
<span class="gp">user:~/src/info-beamer/samples/green$</span> ../../info-beamer red
</pre></div>


<p>or </p>
<div class="codehilite"><pre><span class="gp">user:~/src/info-beamer/samples/green$</span> ../../info-beamer blue
</pre></div>


<p>This is a great feature: You can develop nodes independently and later
include them in other nodes. </p>
<h3 id="rendering-from-vnc">Rendering from VNC</h3>
<p><code>info-beamer</code> contains another useful feature for including content. It can
act as a VNC client. VNC is a cross platform desktop sharing protocol.
<code>info-beamer</code> implements the client side of this protocol. If you setup a
server on a remote machine, <code>info-beamer</code> can connect to this machine and
create a VNC object you can use to render the remote desktop in your
presentation. Here is an example:</p>
<div class="codehilite"><pre><span class="n">gl</span><span class="p">.</span><span class="n">setup</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">768</span><span class="p">)</span>

<span class="n">vnc</span> <span class="o">=</span> <span class="n">resource</span><span class="p">.</span><span class="n">create_vnc</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">192.168.1.1&quot;</span><span class="p">)</span>

<span class="k">function</span> <span class="nc">node</span><span class="p">.</span><span class="nf">render</span><span class="p">()</span>
    <span class="n">vnc</span><span class="p">:</span><span class="n">draw</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>


<p>This will try to create a connection to a running VNC server on
<code>192.168.1.1</code>. The server must not be password protected (since
<code>info-beamer</code> doesn't support any kind of authentication). If you
create the server, be sure that you are in a secure environment. Inside
<code>node.render</code> the content of the remote desktop is drawn onto the screen.</p>
<h3 id="using-glsl-shaders">Using GLSL Shaders</h3>
<p><code>info-beamer</code> supports GLSL shaders. Shaders are small programs that run on
the GPU.  They enable various realtime effects using the raw power of your
GPU.  Shaders come in pairs: A vertex shader and a fragment shader. Vertex
shaders are responsible for transforming 3D positions. Fragment shaders
then calculate the color displayed on each visible pixel of the transformed
object. Fragment shaders can be used to create stunning realtime effects.
<code>info-beamer</code> enables you to pass numeric values and additional textures
into the shader. This allows you to do all kinds of crazy stuff like for
example blending videos with static textures.</p>
<p><code>samples/shader</code> contains a small basic shader example:</p>
<div class="codehilite"><pre><span class="n">gl</span><span class="p">.</span><span class="n">setup</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">480</span><span class="p">)</span>

<span class="n">util</span><span class="p">.</span><span class="n">resource_loader</span><span class="p">{</span>
    <span class="s2">&quot;</span><span class="s">lua.png&quot;</span><span class="p">,</span>
    <span class="s2">&quot;</span><span class="s">shader.vert&quot;</span><span class="p">,</span>
    <span class="s2">&quot;</span><span class="s">shader.frag&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nc">node</span><span class="p">.</span><span class="nf">render</span><span class="p">()</span>
    <span class="n">gl</span><span class="p">.</span><span class="n">clear</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">shader</span><span class="p">:</span><span class="n">use</span><span class="p">{</span>
        <span class="n">Effect</span> <span class="o">=</span> <span class="nb">math.cos</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">now</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span>
    <span class="p">}</span>
    <span class="n">lua</span><span class="p">:</span><span class="n">draw</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">520</span><span class="p">,</span> <span class="mi">440</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>


<p><code>util.resource_loader</code> is a utility function that makes resource loading
very easy. You just give it a number of filenames. It will then detect
which loader is responsible for the given fileformat and load the file into
a global variable whose name is derived from the filename. The above code
will load the image <code>lua.png</code> into the global variable <code>lua</code>. It will also
load the shader pair <code>shader.vert</code> and <code>shader.frag</code> into the global
variable <code>shader</code>. The resource loader will also make sure that changed
files will be reloaded. So if you edit and save for example <code>shader.frag</code>,
<code>info-beamer</code> will instantly reload the shader. You can see changes
to your effect immediatelly. This is great for rapidly development of
effects.</p>
<p>Inside of <code>node.render</code> we first clear the screen. Then we activate the
shader, which was automatically created from the files <code>shader.vert</code> and
<code>shader.frag</code> by <code>util.resource_loader</code>. We pass in a variable <code>Effect</code>
which depends on a time value. This will create a dynamic effect.</p>
<h1 id="reference">Reference</h1>
<h2 id="resource-loading">Resource Loading</h2>
<h3 id="image-resourceload_imagefilename">image = resource.load_image(filename)</h3>
<p>Loads the image file specified by <code>filename</code> into a texture objects.
Please note that image loading is case sensitive. <code>info-beamer</code> supports
the most common file formats.</p>
<p>The returned <code>image</code> objects supports the following methods:</p>
<h4 id="imagedrawx1-y1-x2-y2">image:draw(x1, y1, x2, y2)</h4>
<p>Draws the image into a rectangle specified by the give coordinates.</p>
<h4 id="width-height-imagesize">width, height = image:size()</h4>
<p>Returns the size of the image.</p>
<h3 id="video-resourceload_videofilename">video = resource.load_video(filename)</h3>
<p>Loads any supported video file and returns a 
<code>video</code> object. The <code>video</code> objects supports the following methods:</p>
<h4 id="videodrawx1-y1-x2-y2">video:draw(x1, y1, x2, y2)</h4>
<p>Draws the current video frame into a rectangle specified by the give coordinates.</p>
<h4 id="has_next_frame-videonext">has_next_frame = video:next()</h4>
<p>Decodes the next frame of the video. Returns true, if a frame was decoded
or false if there was no next frame.</p>
<h4 id="width-height-videosize">width, height = video:size()</h4>
<p>Returns the size of the video.</p>
<h4 id="fps-videofps">fps = video:fps()</h4>
<p>Returns the frame per seconds as specified by the video file.</p>
<h3 id="font-resourceload_fontfilename">font = resource.load_font(filename)</h3>
<p>Loads the given Truetype font file and returns a <code>font</code> objects. It
supports the following methods:</p>
<h4 id="width-fontwritex-y-text-size-r-g-b-a">width = font:write(x, y, text, size, r, g, b, [a])</h4>
<p>Writes the provided <code>text</code> to the coordinates given in <code>x</code> and <code>y</code>. The
color is given by <code>r</code>, <code>g</code>, <code>b</code> and <code>a</code>, the red, green, blue and alpha
values. alpha is an optional value. default is 1.0 (opaque). The call will
return the width of the rendered text in screen space.</p>
<p><code>text</code> must be <code>UTF8</code> encoded, if you intend to use characters outside the
ascii range.</p>
<h4 id="width-fontwritex-y-text-size-texturelike">width = font:write(x, y, text, size, texturelike)</h4>
<p>Mostly identical to font:write but will not use a solid color but the
texturelike object. <code>texturelike</code> can be an image, a video or any other
<code>texturelike</code> objects. The texture will be used for each character
individually.</p>
<h3 id="string-resourceload_filefilename">string = resource.load_file(filename)</h3>
<p>Will load the content of the specified file into a string value.
At most 16kb (16384 bytes) are readable.</p>
<h3 id="shader-resourcecreate_shadervertex_shader-fragment_shader">shader = resource.create_shader(vertex_shader, fragment_shader)</h3>
<p>Will create a new <code>shader</code> object. <code>vertex_shader</code> and <code>fragment_shader</code>
are strings containing the shaders in the GLSL language.</p>
<h4 id="shaderusetable_of_shader_variables">shader:use(table_of_shader_variables)</h4>
<p>Will activate the shader and pass in the given variables. A call might look
like this:</p>
<div class="codehilite"><pre><span class="n">shader</span><span class="p">:</span><span class="n">use</span><span class="p">{</span>
    <span class="n">float_value</span> <span class="o">=</span> <span class="mf">123.45</span><span class="p">,</span>
    <span class="n">some_texture</span> <span class="o">=</span> <span class="n">image</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>


<p>You can pass in numerical values. Inside the shader, they will be available
as a float uniform values:</p>
<div class="codehilite"><pre><span class="k">uniform</span> <span class="k">float</span> <span class="n">float_value</span><span class="p">;</span> <span class="c1">// will have the value 123.45</span>
</pre></div>


<p>Textures (which can be images, videos or any other <code>texturelike</code> object)
will be available as a 2d sampler:</p>
<div class="codehilite"><pre><span class="k">uniform</span> <span class="n">sampler2d</span> <span class="n">some_texture</span><span class="p">;</span>
</pre></div>


<p>The shader will be active for the rest of execution of the <code>node.render</code>
call unless deactivated using <code>:deactivate</code>.</p>
<h4 id="shaderdeactivate">shader:deactivate()</h4>
<p>Deactivates the active shader.</p>
<h3 id="vnc-resourcecreate_vnchostname-port">vnc = resource.create_vnc(hostname, [port])</h3>
<p>This call will create VNC client. It will connect to the specified address.
The remote desktop will be available as a <code>texturelike</code> object. If no port
is given, the default value of 5900 will be used.</p>
<h4 id="vncdrawx1-y1-x2-y2">vnc:draw(x1, y1, x2, y2)</h4>
<p>Draws the current remote desktop to the screen.</p>
<h4 id="width-height-vncsize">width, height = vnc:size()</h4>
<p>Returns the size of the remote desktop. Will return 0x0 is the client is
not yet connected to the VNC server.</p>
<h4 id="alive-vncalive">alive = vnc:alive()</h4>
<p>Returns a boolean value that indicates if the client is still connected to
the server. If the client was disconnected (which can have various reasons
like an invalid hostname, a closed connection or invalid VNC packets) it
will not automatically reconnect. It's up to you to create a new client if
you need a persistent connection.</p>
<h3 id="image-resourcerender_childname">image = resource.render_child(name)</h3>
<p>Renders a child node into an <code>image</code> object. Rendering will call
<code>node.render</code> within the child.</p>
<p>The returned <code>image</code> supports the same methods like images objects created
by <code>resource.load_image</code>.</p>
<h2 id="opengl-related-functions">OpenGL Related Functions</h2>
<h3 id="glsetupwidth-height">gl.setup(width, height)</h3>
<p>Initializes the virtual screen of the current node. Will also set the
global variables <code>WIDTH</code> and <code>HEIGHT</code>.</p>
<h3 id="glclearr-g-b-a">gl.clear(r, g, b, a)</h3>
<p>Clears the virtual screen using the given color.</p>
<h3 id="glpushmatrix">gl.pushMatrix()</h3>
<p>Like the native glPushMatrix call, this will save the current ModelView
matrix. This function can only be called inside of <code>node.render</code> (or any
functions called from there). To avoid errors, you can only push 20
matrices. This should be more than enough for normal visualisations.</p>
<h3 id="glpopmatrix">gl.popMatrix()</h3>
<p>Restores a previously saved matrix. Can only be called inside
<code>node.render</code>.</p>
<h3 id="glortho">gl.ortho()</h3>
<p>Resets the view to an orthogonal projection. It will create a projection
where the topleft pixel of the virtualscreen is at <code>0</code>, <code>0</code> and the
bottomright pixel is at <code>WIDTH</code>, <code>HEIGHT</code>. This is the default mode.</p>
<h3 id="glperspectivefov-eyex-eyey-eyez-centerx-centery-centerz">gl.perspective(fov, eyex, eyey, eyez, centerx, centery, centerz)</h3>
<p>This will create a perspective projection. The field of view is given by
<code>fov</code>. The camera (or eye) will be at the coordinates <code>eyex</code>, <code>eyey</code>,
<code>eyez</code>. It will look at <code>centerx</code>, <code>centery</code>, <code>centerz</code>. The up vector of
the camera will always be <code>0</code>, <code>-1</code>, <code>0</code>.</p>
<p>Here are some useful values to try if you want to switch from <code>gl.ortho</code> to
<code>gl.perspective</code>:</p>
<div class="codehilite"><pre><span class="n">gl</span><span class="p">.</span><span class="n">perspective</span><span class="p">(</span>
    <span class="mi">60</span><span class="p">,</span>
    <span class="n">WIDTH</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">WIDTH</span><span class="o">/</span><span class="mf">1.6</span><span class="p">,</span>
    <span class="n">WIDTH</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span>
<span class="p">)</span>
</pre></div>


<h3 id="glrotateangle-x-y-z">gl.rotate(angle, x, y, z)</h3>
<p>Produces a rotation of <code>angle</code> degrees around the vector <code>x</code>, <code>y</code>, <code>z</code>.
Consider using <code>gl.perspective</code> to see the scene in perspective mode. It
might look better.</p>
<h3 id="gltranslatex-y-z">gl.translate(x, y, z)</h3>
<p>Produces a translation by <code>x</code>, <code>y</code>, <code>z</code>. Consider using <code>gl.perspective</code> to
see the scene in perspective mode. It might look better.</p>
<h2 id="misc-functions">Misc Functions</h2>
<h3 id="sysnow">sys.now()</h3>
<p>Returns a timestamp as a floating point number that will increment by 1 for
each passing second. The timestamp is relative to the start of <code>info-beamer</code>.</p>
<h2 id="node-functions">Node Functions</h2>
<h3 id="noderender">node.render()</h3>
<p>You should overwrite this function with your own code. This function will
be called by <code>info-beamer</code> (or by a parent node using
<code>resource.render_child</code>). It should create the current scene.</p>
<h3 id="nodealiasnew_alias">node.alias(new_alias)</h3>
<p>Nodes always have a name and a path. The <code>name</code> is the directory name of the
node. The <code>path</code> is the full path to the node from the toplevel node.</p>
<p>If you send data to a node using TCP (see the <code>input</code> event) or UDP (see
<code>osc</code> and <code>data</code> events), you address the node using its full path. Using
<code>node.alias</code>, you can give your node an alias name. This name must be
unique in a running <code>info-beamer</code> instance.</p>
<h3 id="nodeeventevent_name-event_handler">node.event(event_name, event_handler)</h3>
<p>Registers a new eventhandler. Possible <code>event_name</code>s are described below.
Event handlers cannot be unregistered. Event handlers will be called in the
order of registration.</p>
<h2 id="node-events">Node Events</h2>
<p><code>info-beamer</code> allows you to listen to various events. All events must be
registered using <code>node.event</code>. The following events are available:</p>
<h3 id="nodeeventchild_add-functionchild_name-end">node.event("child_add", function(child_name) ... end)</h3>
<p>Registers an event handler that is called if <code>info-beamer</code> detects that a
child node was added to the current node. The name of the new child node is
provided in <code>child_name</code>. Example usage:</p>
<div class="codehilite"><pre><span class="n">node</span><span class="p">.</span><span class="n">event</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">child_add&quot;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">child_name</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">new child &quot;</span> <span class="o">..</span> <span class="n">child_name</span> <span class="o">..</span> <span class="s2">&quot;</span><span class="s"> added&quot;</span><span class="p">)</span>
<span class="k">end</span><span class="p">)</span>
</pre></div>


<h3 id="nodeeventchild_remove-functionchild_name-end">node.event("child_remove", function(child_name) ... end)</h3>
<p>Registers an event handler that is called if <code>info-beamer</code> detects that a
child node was removed from the current node. The child name is provided in
<code>child_name</code>.</p>
<h3 id="nodeeventcontent_update-functionfilename-end">node.event("content_update", function(filename) ... end)</h3>
<p>Registers an event handler that is called if <code>info-beamer</code> detects that a file was
created or modified in the current node. This allows you to detect updated
resources. </p>
<h3 id="nodeeventcontent_remove-functionfilename-end">node.event("content_remove", function(filename) ... end)</h3>
<p>Registers an event handler that is called if <code>info-beamer</code> detects that a
file was removed from the current node.</p>
<h3 id="nodeeventdata-functiondata-suffix-end">node.event("data", function(data, suffix) ... end)</h3>
<p>Registers a new event handler that will be called if UDP data is sent to
the node. You can send udp data like this:</p>
<div class="codehilite"><pre><span class="gp">user:~$</span> <span class="nb">echo</span> -n <span class="s2">&quot;path:data&quot;</span> | netcat -u localhost 4444
</pre></div>


<p>Where <code>path</code> is the complete path to the node (in case of nested nodes) and
maybe a suffix. <code>data</code> is the data you want to send. <code>info-beamer</code> listens for
incoming UDP packets on port 4444.</p>
<p><code>info-beamer</code> will dispatch packets to the node that best matches the
specified path.  Let's say you have two nodes:</p>
<div class="codehilite"><pre>nested
nested/child
</pre></div>


<p>If you send a packet to <code>nested</code>, the <code>data</code> callback will be called in the
node <code>nested</code>. If you send a packet to <code>nested/child/foobar</code> the <code>data</code>
callback will be called in <code>nested/child</code>. <code>suffix</code> will have the value
<code>foobar</code>. See <code>util.data_mapper</code> for an easier way to receive and dispatch
udp data packets. You can give your node a unique alias name using
<code>node.alias</code>.  This might be useful if you use OSC clients that don't
support changing the paths they create.</p>
<h3 id="nodeeventosc-functionsuffix-end">node.event("osc", function(suffix, ...) ... end)</h3>
<p><code>info-beamer</code> also supports OSC (open sound control) packets via UDP. If
you send an OSC packet containing a float to <code>node/slider/1</code>, the <code>osc</code>
callback will be called with the suffix <code>slider/1</code> and the decoded osc
values. See <code>util.osc_mapper</code> for an easier way to receive and dispatch osc
packets.</p>
<h3 id="nodeeventinput-functionline-end">node.event("input", function(line) ... end)</h3>
<p><code>info-beamer</code> allows incoming TCP connections to port 4444. You'll be
greeted by a welcome line and are expected to provide a node name.
<code>info-beamer</code> will return <code>ok!</code> if you provide a valid node name. From this
moment on, <code>info-beamer</code> will feed you the output of the node. This can be
used for debugging a node from remote.</p>
<p>Any text you type while connected will trigger the <code>input</code> event. The
<code>input</code> event will be given the provided line. This can be used to feed a
node with input from outside sources.</p>
<div class="codehilite"><pre><span class="n">node</span><span class="p">.</span><span class="n">event</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">input&quot;</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">Input was: &quot;</span> <span class="o">..</span> <span class="n">line</span><span class="p">)</span>
<span class="k">end</span><span class="p">)</span>
</pre></div>


<h2 id="utility-functions">Utility Functions</h2>
<p>All utility functions could be rewritten using the functions decribed
above. They are provided for your convenience.</p>
<h3 id="utilresource_loadertable_of_filenames">util.resource_loader(table_of_filenames)</h3>
<p>Creates a magic resource loader that will load the resources from the given
filenames and put them in global variables. It also keeps them updated if
files change. Example usage:</p>
<div class="codehilite"><pre><span class="n">util</span><span class="p">.</span><span class="n">resource_loader</span><span class="p">{</span>
    <span class="s2">&quot;</span><span class="s">font.ttf&quot;</span><span class="p">,</span>
    <span class="s2">&quot;</span><span class="s">image.jpg&quot;</span><span class="p">,</span>
    <span class="s2">&quot;</span><span class="s">video.mp4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;</span><span class="s">shader.vert&quot;</span><span class="p">,</span>
    <span class="s2">&quot;</span><span class="s">shader.frag&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>


<p>This will load the font <code>font.ttf</code> and put the font object into the global
variable <code>font</code>. The global variable <code>image</code> will contain the image object.
And so on.</p>
<p>The <code>util.resource_loader</code> will also detect changes to the files and reload
them.</p>
<h3 id="utilshaderpair_loaderbasename">util.shaderpair_loader(basename)</h3>
<p>Loads the vertex and fragment shader from two files called <code>basename.vert</code>
and <code>basename.frag</code> and returns a shader objects.</p>
<h3 id="utilosc_mapperrouting_table">util.osc_mapper(routing_table)</h3>
<p>Will create a OSC mapper that makes if simple to dispatch OSC messages to
different functions. Think of it as Url-routing for OSC messages:</p>
<div class="codehilite"><pre><span class="n">util</span><span class="p">.</span><span class="n">osc_mapper</span><span class="p">{</span>
    <span class="p">[</span><span class="s2">&quot;</span><span class="s">slider/(.*)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">slider_num</span><span class="p">,</span> <span class="n">slider_arg1</span><span class="p">,</span> <span class="o">..</span><span class="p">.)</span>
        <span class="o">..</span><span class="p">.</span>
    <span class="k">end</span><span class="p">;</span>
    <span class="p">[</span><span class="s2">&quot;</span><span class="s">fader/1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">fader_args</span><span class="p">)</span>
        <span class="o">..</span><span class="p">.</span>
    <span class="k">end</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>The example will allow the node to receive two different type of OSC
messages. If the node is called <code>example</code>, the following OSC path will
trigger the slider callback function:</p>
<div class="codehilite"><pre>/example/slider/123
</pre></div>


<p>In the callback, the argument <code>slider_num</code> will be a string containing the
value <code>123</code> while <code>slider_arg1</code> will contain the first OSC argument.</p>
<h3 id="utildata_mapperrouting_table">util.data_mapper(routing_table)</h3>
<p>Provides the same functionality as the <code>osc_mapper</code>, but handles simple UDP
packets.</p>
<h3 id="video-utilvideoplayerfilename-opt_table">video = util.videoplayer(filename, [opt_table])</h3>
<p>Provides a small wrapper around <code>resource.load_video</code>. Provides simplified
playback of videos by handling framerate issues. <code>opt_table</code> is an optional
table containing the key <code>loop</code>. It is a boolean value that indicates if
the videoplayer should loop the video.</p>
<p><code>util.videoplayer</code> will return a <code>video</code> object that has the following method:</p>
<h4 id="videodrawx1-y1-x2-y2_1">video:draw(x1, y1, x2, y2)</h4>
<p>Draws the current video frame into a rectangle specified by the give coordinates.</p>
<h3 id="utildraw_correctobj-x1-y1-x2-y2-alpha">util.draw_correct(obj, x1, y1, x2, y2, alpha)</h3>
<p>It is often necessary to display images, videos, child nodes or vnc streams
using the correct aspect ratio (so they don't look stretched).
<code>util.draw_correct</code> does this for you.</p>
<div class="codehilite"><pre><span class="c1">-- maybe wrong, stretches the image</span>
<span class="n">image</span><span class="p">:</span><span class="n">draw</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">)</span>

<span class="c1">-- keeps aspect ratio</span>
<span class="n">util</span><span class="p">.</span><span class="n">draw_correct</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">)</span>
</pre></div>


<h3 id="ppvariable">pp(variable)</h3>
<p>Pretty print the given Lua object.</p>
<h2 id="global-variables">Global Variables</h2>
<h3 id="width">WIDTH</h3>
<p>Current width of the virtual screen as set by <code>gl.setup</code>. Writing to this
variable has no effect. Use <code>gl.setup</code> to change the virtual screen size.</p>
<h3 id="height">HEIGHT</h3>
<p>Current height of the virtual screen as set by <code>gl.setup</code>. Writing to this
variable has no effect. Use <code>gl.setup</code> to change the virtual screen size.</p>
<h3 id="name">NAME</h3>
<p>Name of the current node (its directory name).</p>
<h3 id="path">PATH</h3>
<p>Complete path of the node. </p>
<h3 id="contents">CONTENTS</h3>
<p>Table of available files in the directory of the node. The key contains the
filename, the value is the timestamp (comparable to <code>sys.now()</code>) of the
last change.</p>
<h3 id="childs">CHILDS</h3>
<p>Table of child nodes. The key contains the childs name. These can the
rendered using <code>resource.render_child</code>. The value is a timestamp
(comparable to <code>sys.now()</code>) of the first detection of the child node.</p>
<h1 id="contributing">Contributing</h1>
<p>Thanks for your interest in <code>info-beamer</code>. <code>info-beamer</code> tries to be a
simple framework for building interactive realtime presentations. Lets keep
it that way.</p>
<h2 id="project-philosophy">Project Philosophy</h2>
<ul>
<li>
<p>Keep it simple. <code>info-beamer</code> avoids unnecessary clutter. If a simple external 
   Script could solve a problem, there is no need to do it in <code>info-beamer</code>. If a
   problem is solvable within Lua, there is no need to include a C-version
   (unless speed prohibits a Lua solution).</p>
</li>
<li>
<p>Keep it small. <code>info-beamer</code> is a simple self-contained binary. It shouldn't
   depend on files somewhere in the filesystem. Keep <code>info-beamer</code> portable.</p>
</li>
<li>
<p>Keep it robust. <code>info-beamer</code> tries to provide a crash free environment. It
   shouldn't be possible to crash <code>info-beamer</code> by using the provided API.</p>
</li>
<li>
<p>Keep it safe. <code>info-beamer</code> tries to provide a secure environment. Usercode 
   is sandboxed and memory and processing time is limited. It should be
   safe to execute random node code without worrying about malicious
   behaviour.</p>
</li>
<li>
<p>Keep it statefree. It should be possible to develop a node independently
   from other nodes. Composing them shouldn't change their behaviour.
   OpenGL or other state should not leak into or from child nodes.</p>
</li>
<li>
<p>Keep it scriptable. <code>info-beamer</code> embraces scripting. Not just from the inside but
   also from the outside. It provides several ways to control a running
   instance: Changing files, sending UDP/OSC packets or using a TCP
   connection. Make it easy to script things.</p>
</li>
<li>
<p>Keep it readable. The core <code>info-beamer</code> code tries to be simple. It should be
   possible to read and hopefully understand the complete sourcecode
   in one evening.</p>
</li>
<li>
<p>Keep it compilable. <code>info-beamer</code> tries to use libraries that are widely 
   available. It shouldn't be necessary to build obscure dependencies.
   <code>info-beamer</code> uses a simple GNU Makefile. It shouldn't be necessary to 
   include a buildsystem that creates files larger than all of <code>info-beamer</code>s
   sourcecode combined.</p>
</li>
</ul>
<h2 id="contributing_1">Contributing</h2>
<p>Feel free to fork and enhance <code>info-beamer</code> and send me pull requests.
Please keep <code>info-beamer</code> clean and simple.</p>  </body>
</html>
